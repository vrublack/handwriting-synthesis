import re
from matplotlib import pyplot as plt

def extract_d_from_svg(svg):
    all_x = []
    all_y = []
    for m in re.finditer(r'(?<![\w])d="(.*?)"', svg):
        match_str = m.group(0)
        stroke_x, stroke_y = path_to_points(match_str)
        all_x.extend(stroke_x)
        all_y.extend(stroke_y)

    x_min = min(all_x)
    y_min = min(all_y)
    for i in range(len(all_x)):
        all_x[i] -= x_min
        all_y[i] -= y_min

    plt.scatter(all_x, all_y)
    max_val = max(max(all_x), max(all_y))
    plt.xlim(0, max_val)
    plt.ylim(0, max_val)
    plt.show()

def path_to_points(svg_d):
    last_x = 0
    last_y = 0
    all_x = []
    all_y = []
    for m in re.finditer(r'm.*?(?=c)', svg_d):
        match_str = m.group(0)
        delta_x = float(match_str[2:].split(',')[0])
        delta_y = float(match_str[2:].split(',')[1])
        last_x += delta_x
        last_y += delta_y
        all_x.append(last_x)
        all_y.append(-last_y)
        print '%f, %f' % (last_x, last_y)

    return all_x, all_y



if __name__ == '__main__':
    sample_svg_d_s = 'm 131.848,95.389916 c 0,1.19518 -0.96919,2.16485 -2.16469,2.16485 -1.19518,0 -2.16484,-0.96919 -2.16484,-2.16485 0,-1.19517 0.96919,-2.16484 2.16484,-2.16484 1.19518,0 2.16469,0.96919 2.16469,2.16484 z m -2.92651,2.02623 c -1.12993,-0.42491 -2.25986,-0.84983 -3.38979,-1.27475 l 1.52302,-4.05246 c 1.12993,0.42492 2.26001,0.84983 3.38994,1.27475 m -4.91328,2.77803 c -0.58087,-0.20052 -1.17448,-0.35489 -1.77907,-0.46152 -3.0481,-0.41537 -6.11116,-0.53632 -9.18902,-0.36126 l -0.0478,-4.79566 c 3.47875,0.003 6.92662,0.31351 10.34362,0.93418 0.74479,0.16551 1.47527,0.37558 2.19349,0.6318 m -12.49143,3.22937 c -3.15314,0.0636 -6.25089,0.48698 -9.29358,1.28429 -0.65408,0.20212 -1.29066,0.45038 -1.90735,0.74798 l -2.34356,-4.83831 c 0.82914,-0.37559 1.68295,-0.68751 2.55984,-0.93578 3.59349,-0.84346 7.23981,-1.19358 10.93897,-1.05353 m -11.15525,6.82794 c -2.11137,1.02649 -3.932939,2.42425 -5.464709,4.193944 l -4.25696,-3.589194 c 2.07954,-2.32319 4.53897,-4.13776 7.378109,-5.44307 m -3.121149,9.032264 c -1.25247,1.50233 -2.12267,3.19849 -2.61156,5.0877 l -5.42525,-1.22064 c 0.64454,-2.79474 1.90417,-5.2801 3.77985,-7.456254 m 1.6454,8.676894 c -0.52677,2.48823 -0.77504,5.0051 -0.74639,7.55222 l -5.30621,0.0796 c -0.12731,-2.97776 0.0796,-5.92974 0.62703,-8.85482 m 4.6787,8.77286 c 10e-4,0.69228 0.0477,1.37978 0.15914,2.06395 0.41378,2.24569 1.23815,4.33239 2.47534,6.26043 l -4.17946,2.70721 c -1.68693,-2.49507 -2.83866,-5.21342 -3.45519,-8.15537 -0.1671,-0.92463 -0.26895,-1.85547 -0.30397,-2.79426 m 7.93862,8.24242 c 2.35678,3.66718 4.906429,7.19526 7.649289,10.58504 l -3.73815,3.0021 c -2.853619,-3.51073 -5.550489,-7.13748 -8.090599,-10.87993 m 11.828749,7.87783 c 3.04922,3.79369 5.84109,7.76738 8.37563,11.92201 l -4.06264,2.45401 c -2.43762,-3.96477 -5.12128,-7.75608 -8.05114,-11.37392 m 12.11378,8.91991 c 2.42123,4.06296 4.40131,8.33107 5.93976,12.80447 l -4.62268,1.53574 c -1.33681,-4.16863 -3.1299,-8.13054 -5.37972,-11.8854 m 10.0024,10.35045 c 1.54052,4.5038 2.60838,9.11693 3.20518,13.83923 l -5.11937,0.57769 c -0.46629,-4.38587 -1.36865,-8.67975 -2.70849,-12.88197 m 7.82786,12.30428 c 0.52517,3.99119 0.75275,7.99798 0.67955,12.02004 l -5.46328,-0.28646 c 0.19574,-3.72621 0.0796,-7.44511 -0.3358,-11.15604 m 5.79908,11.44234 c -0.0478,0.92782 -0.14323,1.84879 -0.29124,2.76451 -0.60952,3.12162 -1.68566,6.0763 -3.22825,8.86388 l -5.02531,-2.75559 c 1.26679,-2.21593 2.19285,-4.56316 2.77675,-7.04311 0.14323,-0.69864 0.24509,-1.40525 0.30397,-2.11599 m 1.94395,11.91469 c -1.37342,2.61395 -2.9986,5.0573 -4.87635,7.33053 -0.50131,0.57451 -1.02967,1.12356 -1.58508,1.64603 l -3.95905,-4.34147 c 0.43765,-0.39945 0.85143,-0.81959 1.24451,-1.26201 1.58827,-1.90163 2.97283,-3.94473 4.15145,-6.12867 m -1.43548,11.73215 c -0.56337,0.51404 -1.15221,0.99784 -1.76492,1.45299 -2.21959,1.5644 -4.59546,2.84297 -7.12745,3.83444 l -2.21291,-5.59744 c 2.05567,-0.76708 3.99374,-1.7611 5.81451,-2.97951 0.46152,-0.32784 0.90554,-0.67796 1.33204,-1.05195 m -4.93332,9.62842 c -4.292769,1.58986 -8.734189,2.39004 -13.323919,2.40293 l -0.0796,-6.1414 c 3.84557,0.0159 7.57783,-0.5952 11.196779,-1.85897 m -11.110999,8.00037 c -3.62198,0.0955 -7.13765,-0.44402 -10.54748,-1.6427 -0.98988,-0.38513 -1.94809,-0.83869 -2.8732,-1.36068 l 3.07117,-5.35156 c 0.6716,0.37558 1.36865,0.70023 2.08862,0.97396 2.64705,0.89758 5.37209,1.30976 8.17511,1.23974 m -13.3349,3.13786 c -3.23764,-1.82189 -6.02777,-4.16976 -8.37022,-7.04311 l 4.75875,-3.76951 c 1.8943,2.22166 4.12185,4.04228 6.68264,5.46106 m -11.44139,-1.69155 c -1.63632,-2.084 -2.67363,-4.4298 -3.11223,-7.03643 -0.1114,-0.7814 -0.15915,-1.56758 -0.14323,-2.3563 l 5.34296,-0.19574 c 0.35808,2.17773 1.24611,4.11755 2.66472,5.81976 m -8.00768,-5.62322 c 0.0318,-0.98033 0.23712,-1.92629 0.60316,-2.83692 0.30714,-0.69546 0.68273,-1.35273 1.12515,-1.97228 0.3724,-0.49812 0.77344,-0.97237 1.20313,-1.42275 1.66386,-1.61309 3.50198,-2.99813 5.51485,-4.15638 l 2.15545,3.29684 c -1.36546,0.9676 -2.61109,2.06936 -3.73576,3.30512 -0.27851,0.32784 -0.53791,0.67 -0.77981,1.02648 -0.24986,0.38354 -0.45675,0.78936 -0.61907,1.21587 -0.16074,0.44083 -0.20212,0.88962 -0.12732,1.34636 m 3.10523,-10.19163 c 2.4042,-1.41957 4.80856,-2.83962 7.21276,-4.25951 l 1.73738,2.65677 c -2.26494,1.63314 -4.52973,3.26628 -6.79468,4.89958 m 7.51322,-6.22797 c 0,0.87689 -0.71137,1.58668 -1.58667,1.58668 -0.87689,0 -1.58667,-0.70979 -1.58667,-1.58668 0,-0.87688 0.71137,-1.58667 1.58667,-1.58667 0.87689,0 1.58667,0.71138 1.58667,1.58667 z'
    sample_svg_d_d = 'm 159.19813,195.25367 c 0,0.0751 -0.0609,0.13599 -0.13603,0.13599 -0.0751,0 -0.13603,-0.0609 -0.13603,-0.13599 0,-0.0752 0.0609,-0.13604 0.13603,-0.13604 0.0751,0 0.13603,0.0609 0.13603,0.13604 z m -0.0594,0.11235 c -0.0533,0.0401 -0.10671,0.08 -0.16005,0.12009 l -0.16345,-0.23971 c 0.0567,-0.0351 0.11349,-0.0701 0.17025,-0.10513 m -0.007,0.34484 c -0.12886,0.0931 -0.27033,0.15953 -0.42435,0.19939 l -0.071,-0.31821 c 0.11815,-0.02 0.22878,-0.0603 0.33196,-0.12089 m -0.26091,0.4391 c -0.0438,0.0108 -0.088,0.0197 -0.13257,0.0265 -0.1983,0.025 -0.39748,0.0362 -0.5975,0.0338 l -0.004,-0.33377 c 0.22189,-0.001 0.44273,-0.0162 0.66248,-0.0448 m -0.65902,0.37853 c -0.14066,-0.001 -0.28039,0.009 -0.41917,0.0307 -0.0702,0.0116 -0.13759,0.0323 -0.20204,0.062 l -0.15166,-0.2764 c 0.0846,-0.0446 0.17378,-0.0771 0.26741,-0.0975 0.16559,-0.0334 0.33291,-0.0509 0.502,-0.0525 m -0.61775,0.42644 c -0.13621,0.0751 -0.25495,0.17187 -0.35624,0.29037 l -0.22553,-0.18655 c 0.11952,-0.15398 0.26289,-0.28074 0.43011,-0.38022 m -0.20458,0.56677 c -0.10957,0.12623 -0.18669,0.26984 -0.23135,0.43088 l -0.25453,-0.0599 c 0.0439,-0.20585 0.13071,-0.39169 0.26035,-0.55757 m -0.006,0.61743 c -0.0445,0.16221 -0.062,0.32717 -0.0527,0.49488 l -0.25601,0.0113 c -0.003,-0.19065 0.0154,-0.37935 0.0542,-0.56607 m 0.20179,0.55474 c 0.002,0.0784 0.0226,0.1511 0.0613,0.21805 0.01,0.0138 0.0218,0.0259 0.0354,0.0361 l -0.17173,0.21625 c -0.0517,-0.0443 -0.0919,-0.0974 -0.12061,-0.15928 -0.0397,-0.0958 -0.0598,-0.19569 -0.0604,-0.29975 m 0.35274,0.24278 c 0.021,0.0127 0.0432,0.0226 0.0667,0.0298 0.0244,0.008 0.049,0.014 0.074,0.0192 0.11239,0.0205 0.22577,0.0323 0.34011,0.0353 l -0.0185,0.30268 c -0.14629,-0.01 -0.29016,-0.0337 -0.43155,-0.0716 -0.0337,-0.0103 -0.0666,-0.0226 -0.0989,-0.0367 -0.037,-0.0169 -0.0715,-0.0377 -0.10354,-0.0626 m 0.6525,-0.13183 c 0.2649,0.0102 0.52719,-0.0112 0.78684,-0.0642 l 0.0649,0.32342 c -0.28811,0.0531 -0.5782,0.0676 -0.87027,0.0434 m 0.80533,-0.36685 c 0.26973,-0.0631 0.52242,-0.16786 0.75804,-0.31443 l 0.17597,0.29167 c -0.27019,0.1651 -0.55986,0.2805 -0.86907,0.34618 m 0.6931,-0.63785 c 0.28671,-0.17802 0.55591,-0.37952 0.80758,-0.60452 l 0.2292,0.25957 c -0.26825,0.2376 -0.55516,0.44979 -0.86081,0.63662 m 0.63161,-0.89619 c 0.29182,-0.26011 0.57552,-0.52878 0.85115,-0.806 l 0.24786,0.24755 c -0.28148,0.28166 -0.57143,0.55432 -0.86981,0.81802 m 0.62195,-1.06557 c 0.43247,-0.44129 0.85831,-0.88893 1.27748,-1.34292 l 0.25276,0.23344 c -0.41899,0.46041 -0.84642,0.91274 -1.28238,1.35703 m 1.02962,-1.59047 c 0.40855,-0.43543 0.8086,-0.87845 1.20015,-1.32912 l 0.2546,0.21428 c -0.39204,0.45706 -0.79269,0.90649 -1.20199,1.34828 m 0.94739,-1.56256 c 0.21477,-0.2509 0.41176,-0.51499 0.59094,-0.79227 l 0.27573,0.17233 c -0.18486,0.29203 -0.38887,0.57009 -0.61207,0.83422 m 0.33634,-1.00655 c 0.1356,-0.20994 0.25234,-0.42975 0.35013,-0.65948 l 0.29799,0.12005 c -0.10477,0.24726 -0.22888,0.4845 -0.37239,0.71176 m 0.0744,-0.83181 c 0.0643,-0.15029 0.10862,-0.30593 0.13307,-0.46701 l 0.31898,0.0331 c -0.004,0.0396 -0.0103,0.079 -0.0179,0.11818 -0.0323,0.14929 -0.0777,0.29453 -0.13621,0.43575 m -0.16492,-0.58706 c 0.002,-0.0137 0.002,-0.0274 -7e-5,-0.041 0.0264,0.0182 0.0241,0.0247 -0.007,0.0195 l -0.0181,-0.31676 c 0.0777,-0.006 0.15004,0.0105 0.21693,0.0495 0.0194,0.0132 0.0372,0.0284 0.0532,0.0455 0.0193,0.0222 0.0352,0.0467 0.0476,0.0734 0.0258,0.0653 0.0345,0.13296 0.0263,0.20303 m -0.3259,-0.0546 c -0.0232,0.001 -0.046,0.006 -0.0681,0.0135 -0.0199,0.007 -0.0392,0.0153 -0.058,0.025 -0.0748,0.0426 -0.14245,0.0947 -0.20292,0.15631 l -0.22157,-0.22609 c 0.0896,-0.0899 0.19064,-0.16412 0.303,-0.22261 0.0322,-0.0152 0.0652,-0.0282 0.0991,-0.0389 0.0426,-0.0126 0.0861,-0.0206 0.13035,-0.024 m -0.31086,0.51163 c -0.17636,0.18031 -0.33786,0.37317 -0.48447,0.57859 l -0.26233,-0.1947 c 0.16055,-0.21597 0.3356,-0.41927 0.52522,-0.60998 m -0.26289,0.80468 c -0.18126,0.25026 -0.35218,0.50737 -0.51273,0.77139 l -0.2897,-0.17854 c 0.16856,-0.27041 0.34858,-0.53291 0.5401,-0.78755 m -0.2504,0.96609 c -0.16852,0.27943 -0.31725,0.56903 -0.44623,0.86882 l -0.32057,-0.13956 c 0.13783,-0.31376 0.29686,-0.61638 0.4771,-0.9078 m -0.15653,1.04736 c -0.12485,0.28712 -0.22556,0.5824 -0.30222,0.88586 l -0.34107,-0.0821 c 0.0798,-0.32385 0.18743,-0.63828 0.32272,-0.94329 m 0.0183,1.02542 c -0.0746,0.32967 -0.11977,0.66343 -0.13554,1.00136 l -0.33652,-0.0154 c 0.01,-0.36033 0.0537,-0.71632 0.13099,-1.06807 m 0.20553,1.08349 c -0.0163,0.22415 -0.011,0.44764 0.0157,0.67038 0.007,0.0463 0.0177,0.092 0.0311,0.13698 l -0.30244,0.10139 c -0.0183,-0.0555 -0.0329,-0.11204 -0.044,-0.16947 -0.0382,-0.25005 -0.0505,-0.50162 -0.0368,-0.7547 m 0.3833,0.82278 c 0.0298,0.0987 0.0812,0.18419 0.15395,0.25651 0.024,0.022 0.0497,0.0417 0.0773,0.0591 l -0.12866,0.24842 c -0.0814,-0.0376 -0.15381,-0.0881 -0.21735,-0.15134 -0.0848,-0.0902 -0.14739,-0.19395 -0.18764,-0.31129 m 0.53365,0.21421 c 0.10347,0.0672 0.21473,0.11543 0.33383,0.14478 l -0.0231,0.22662 c -0.0318,-0.002 -0.0635,-0.006 -0.095,-0.011 -0.1191,-0.0238 -0.23386,-0.0612 -0.34438,-0.11201 m 0.46249,-0.10364 c 0.0529,0.009 0.10569,0.0173 0.15854,0.0259 l -0.0211,0.20729 c -0.0535,-0.002 -0.10704,-0.004 -0.16052,-0.007 m 0.27524,-0.097 c 0,0.0575 -0.0466,0.10417 -0.10417,0.10417 -0.0575,0 -0.10418,-0.0466 -0.10418,-0.10417 0,-0.0575 0.0466,-0.10421 0.10418,-0.10421 0.0575,0 0.10417,0.0467 0.10417,0.10421 z'
    #path_to_points(sample_svg_d_d)

    with open("C:\Users\Valentin\Handwriting Synthesis\sentence.svg") as f:
        extract_d_from_svg('\n'.join(f.readlines()))
